<beans xmlns="http://www.springframework.org/schema/beans"
	xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:aop="http://www.springframework.org/schema/aop"
	xmlns:context="http://www.springframework.org/schema/context"
	xmlns:mvc="http://www.springframework.org/schema/mvc" xmlns:tx="http://www.springframework.org/schema/tx"
	xsi:schemaLocation="http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans-3.0.xsd
		http://www.springframework.org/schema/aop http://www.springframework.org/schema/aop/spring-aop-3.0.xsd
		http://www.springframework.org/schema/context http://www.springframework.org/schema/context/spring-context-3.0.xsd
		http://www.springframework.org/schema/mvc http://www.springframework.org/schema/mvc/spring-mvc-3.0.xsd
		http://www.springframework.org/schema/tx http://www.springframework.org/schema/tx/spring-tx-3.0.xsd">

	<!-- 
		使用<aop>标签需要导入的命名空间:
		xsi:schemaLocation中加入:
			http://www.springframework.org/schema/aop http://www.springframework.org/schema/aop/spring-aop-3.2.xsd
		添加:
			xmlns:aop="http://www.springframework.org/schema/aop"
	 -->
	 
	<aop:aspectj-autoproxy />
	 
	<!-- 声明切面类,AOP before-->
	<bean id="apiProcessAspect" class="com.jeedcp.api.ProcessAspect">
		<property name="appSecretManager" ref="appSecretManager"/>
		<!-- [配置项]:拦截器
			新建一个类并继承org.durcframework.open.InterceptorAdapter,添加到<list>中即可
		<property name="processors">
			<list>
				<bean class="com.xx.MyInterceptor" />
			</list>
		</property>
		 -->
	</bean>
	
	<aop:config>
		<!-- 切入点,带有org.springframework.web.bind.annotation.RequestMapping注解的方法 -->
		<aop:pointcut id="apiMethod" expression="@annotation(org.springframework.web.bind.annotation.RequestMapping)"/>
		<!-- 定义切面类 -->
		<aop:aspect ref="apiProcessAspect">
			<!-- method指切面类中的方法
				 pointcut-ref指向的是切入点
				 可以概括为:method方法处理pointcut-ref表达式中的内容
			-->
			<aop:around method="process" pointcut-ref="apiMethod"/>
		</aop:aspect>
	</aop:config>
	
	<!-- 管理站点秘钥 -->
    <bean id="appSecretManager" class="com.jeedcp.api.FileAppSecretManager">
   		<!-- 可以使用这种方式加载文件,默认加载类路径下的appSecret.properties
    	<property name="appSecretFile" value="file:${API_CONFIG_HOME}/appSecret.properties"/>
    	 -->
    </bean>
    
    <!-- 拦截所有请求,即/* -->
	<mvc:interceptors>
		<bean class="com.jeedcp.api.WebContextInterceptor" />
	</mvc:interceptors>

</beans>