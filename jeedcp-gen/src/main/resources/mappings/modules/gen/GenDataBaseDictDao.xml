<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.jeedcp.modules.gen.dao.GenDataBaseDictDao">
    
	<select id="findTableList" resultType="GenTable">
        SELECT
        t.TABLE_NAME AS name,
        c.COMMENTS AS comments
        FROM user_tables t, user_tab_comments c
        WHERE t.table_name = c.table_name
        <if test="name != null and name != ''">
            AND t.TABLE_NAME = upper(#{name})
        </if>
        ORDER BY t.TABLE_NAME
	</select>
	
	<select id="findTableColumnList" resultType="GenTableColumn">
        SELECT
        t.COLUMN_NAME AS name,<!--
				t.DATA_TYPE,
				t.DATA_LENGTH,
				t.DATA_PRECISION,
				t.DATA_SCALE, -->
        (CASE WHEN t.NULLABLE = 'Y' THEN '1' ELSE '0' END) AS isNull,
        (t.COLUMN_ID * 10) AS sort,
        c.COMMENTS AS comments,
        decode(t.DATA_TYPE,'DATE',t.DATA_TYPE || '(' || t.DATA_LENGTH || ')',
        'VARCHAR2', t.DATA_TYPE || '(' || t.DATA_LENGTH || ')',
        'VARCHAR', t.DATA_TYPE || '(' || t.DATA_LENGTH || ')',
        'NVARCHAR2', t.DATA_TYPE || '(' || t.DATA_LENGTH/2 || ')',
        'CHAR', t.DATA_TYPE || '(' || t.DATA_LENGTH || ')',
        'NUMBER',t.DATA_TYPE || (nvl2(t.DATA_PRECISION,nvl2(decode(t.DATA_SCALE,0,null,t.DATA_SCALE),
        '(' || t.DATA_PRECISION || ',' || t.DATA_SCALE || ')',
        '(' || t.DATA_PRECISION || ')'),'(18)')),t.DATA_TYPE) AS jdbcType
        FROM user_tab_columns t, user_col_comments c
        WHERE t.TABLE_NAME = c.table_name
        AND t.COLUMN_NAME = c.column_name
        <if test="name != null and name != ''">
            AND t.TABLE_NAME = upper(#{name})
        </if>
        ORDER BY t.COLUMN_ID
	</select>
	
	<select id="findTablePK" resultType="string">
        SELECT lower(cu.COLUMN_NAME) AS columnName
        FROM user_cons_columns cu, user_constraints au
        WHERE cu.constraint_name = au.constraint_name
        AND au.constraint_type = 'P'
        AND au.table_name = upper(#{name})
	</select>
	
</mapper>